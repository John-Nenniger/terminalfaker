var version="1.4.4";function Path(){this.path="/";Path.prototype.isValidDirectory=function(a){if(a==""){return false}var b=a.replace(/[^A-Za-z\d\-_~]/,"");if(b.length!=a.length){return false}return true};Path.prototype.isValidFilename=function(b){if(b==""){return false}var c=b.replace(/[^A-Za-z\d\.\-_~]/,"");c=c.replace(/^\.|\.$/g,"");if(c.length!=b.length){return false}var a=c.match(/\./g);if(a!=null&&a.length>1){return false}return true};Path.prototype.isValidDirectoryPath=function(a){if(a==""){return false}var b=a.replace(/[^A-Za-z\d\/\-_~]/,"");b=b.replace(/(\/)\/+/g,"$1");if(b.length!=a.length){return false}return true};Path.prototype.getDirectoryPart=function(a,b){var c="";if(a==""){return false}if(b&&this.isValidDirectory(a)){c=a}else{if(!b&&this.isValidFilename(a)){return false}else{c=a.substring(0,a.lastIndexOf("/"))}}return c+"/"};Path.prototype.getFilenamePart=function(b,a){if(b==""){return false}if(a&&this.isValidFilename(b)){return b}else{if(!a&&this.isValidDirectory(b)){return false}}var c=b.split("\\").pop().split("/").pop();if(c==""){return false}return c};Path.prototype.parseDirPathToSelector=function(c){if(c=="/"||c=="~"){return"d[path='/'][name='/']"}c=c.replace(/\/+$/,"");var a=c.split("\\").pop().split("/").pop();var b=c.substring(0,c.lastIndexOf("/")+1);return"d[path='"+b+a+"/'][name='"+a+"']"};Path.prototype.parseFilePathToSelector=function(c){var a=c.split("\\").pop().split("/").pop();var b=c.substring(0,c.lastIndexOf("/")+1);return"f[path='"+b+"'][name='"+a+"']"}}var Terminal=(function(){var l={};l.pathMgr=new Path();var e=38,h=40,i=9,g=13,c=20;var d=function(n,r,m){var q=r.parentNode.cloneNode(true);var p=document.querySelectorAll("[contenteditable=true]");for(var o=0;o<p.length;o++){p[o].setAttribute("contenteditable",false)}if(l.prompt){q.querySelector(".prompt").textContent=l.prompt}if((typeof m!=="undefined")&&m){while(n.firstChild){n.removeChild(n.firstChild)}}n.appendChild(q);q.querySelector(".prompt").innerHTML=l.customPrompt();q.querySelector(".input").innerHTML=" ";q.querySelector(".input").focus()};var b=function(n,o,m){n.innerHTML+="<div>"+(l.commands[o].exe(m))+"</div>"};var j=function(m){if(l.history.length>=c){l.history.shift()}l.history.push(m);localStorage.setItem("history",l.history);l.historyIndex=l.history.length};var a=function(p,r){var q=false;if(r==e&&l.historyIndex>0){p.textContent=l.history[--l.historyIndex];q=true}else{if(r==h){if(l.historyIndex<l.history.length){++l.historyIndex}if(l.historyIndex<l.history.length){p.textContent=l.history[l.historyIndex]}else{p.textContent=" "}q=true}}if(q){try{var m=document.createRange();var o=window.getSelection();m.setStart(p.childNodes[0],p.textContent.length);m.collapse(true);o.removeAllRanges();o.addRange(m)}catch(n){}}};var k=function(n){var m=l.commands,o=new RegExp("^"+n,"ig"),q=[];for(var p in m){if(m.hasOwnProperty(p)&&p.match(o)){q.push(p)}}return q};var f=function(){var m;if(typeof(XMLSerializer)!=="undefined"){m=(new XMLSerializer()).serializeToString(l.filesystem)}else{if("outerHTML" in l.filesystem){m=l.filesystem.outerHTML}else{m=originalFilesystem}}localStorage.setItem("filesystem",m)};l.bootTerminalStart=function(o){var n="Type 'help' to get started.";if(typeof bootMessageLines==="undefined"){bootMessageLines=[n]}if((typeof useBootLoader!=="undefined")&&!useBootLoader){bootMessageLines=[n]}var p=document.getElementById("boot");if(p==null){var m=document.createElement("p");m.setAttribute("id","boot");o.insertBefore(m,o.firstChild)}p=document.getElementById("boot");l.bootTerminalMessage(o,p,bootMessageLines,0)};l.bootTerminalMessage=function(p,n,m,o){if(o==0){p.querySelector(".hidden").style.display="none";n.innerHTML=""}n.innerHTML+=m[o];if(o+1 in m){setTimeout(function(){l.bootTerminalMessage(p,n,m,o+1)},500)}else{p.querySelector(".hidden").style.display="";p.querySelector(".input").focus()}};l.catFile=function(o){var n=null;var m="";if(o.substr(0,1)!="/"){var m=l.pathMgr.parseFilePathToSelector(l.path+o);var n=l.filesystemPointer.querySelector(m)}if(typeof n==="undefined"||n==null||n.nodeName!="f"){m=l.pathMgr.parseFilePathToSelector(o);var n=l.filesystem.querySelector(m);if(typeof n==="undefined"||n==null||n.nodeName!="f"){return false}}return n.querySelector("contents").innerHTML};l.changeDirectory=function(n){if(n==".."){if(l.filesystemPointer.getAttribute("name")!="/"){l.filesystemPointer=l.filesystemPointer.parentNode.parentNode;l.path=l.filesystemPointer.getAttribute("path");n=l.path;return true}return true}if(n=="."){return true}if(!l.pathMgr.isValidDirectoryPath(n)){return false}var m=l.findDirectory(n);if(m===false){return false}l.path=m.getAttribute("path");if(l.path.substr(-1)!="/"){l.path+="/"}n=l.path;l.filesystemPointer=m;return true};l.findDirectory=function(o){var n=null;var m="";if(o.substr(0,1)!="/"){var m=l.pathMgr.parseDirPathToSelector(l.path+o);var n=l.filesystemPointer.querySelector(m)}if(typeof n==="undefined"||n==null||n.nodeName!="d"){m=l.pathMgr.parseDirPathToSelector(o);var n=l.filesystem.querySelector(m);if(typeof n==="undefined"||n==null||n.nodeName!="d"){return false}}return n};l.deleteFile=function(n){if(!l.pathMgr.isValidFilename(n)){return"rm: Supplied filename is not valid."}var o=l.filesystemPointer.querySelector("c");var m=o.querySelector("f[path='"+l.path+"'][name='"+n+"']");if(m===null){return"rm: No such file."}o.removeChild(m);f();return true};l.makeFile=function(o){if(!l.pathMgr.isValidFilename(o)){return"touch: Supplied filename is not valid."}var p=l.filesystemPointer.querySelector("c");var n=p.querySelector("f[path='"+l.path+"'][name='"+o+"']");if(n!=null){return"touch: File already exists."}var m=document.createElement("f");m.setAttribute("name",o);m.setAttribute("path",l.path);m.innerHTML="<contents></contents>";p.appendChild(m);f();return true};l.init=function(m,n,o){l.commands=n;l.customPrompt=o;l.initSession();m.addEventListener("keydown",function(q){if(q.keyCode==i){var t=q.target;var s=k(t.textContent.replace(/\s+/g,""));if(s.length==1){t.textContent=s[0];var p=document.createRange();var r=window.getSelection();p.setStart(t.childNodes[0],s[0].length);p.collapse(true);r.removeAllRanges();r.addRange(p)}q.preventDefault(true);return false}});m.addEventListener("keyup",function(p){if(l.historyIndex<0){return}a(p.target,p.keyCode)});m.addEventListener("keypress",function(r){var s=r.target;if(r.keyCode!=g){return false}var p=s.textContent.trim();var q=p.match(/(?=\S)[^"\s]*(?:"[^\\"]*(?:\\[\s\S][^\\"]*)*"[^"\s]*)*/g);if(q==null){d(m,s,false);r.preventDefault();return}q=q.map(function(t){if(t.charAt(0)==='"'&&t.charAt(t.length-1)==='"'){return t.substr(1,t.length-2)}else{return t}});if(q[0]){if(q[0].toLowerCase() in l.commands){b(m,q[0].toLowerCase(),q);j(s.textContent)}else{m.innerHTML+=q[0]+": command not found"}}d(m,s,(["clear","reboot"].indexOf(q[0].toLowerCase())>=0));r.preventDefault()});m.querySelector(".prompt").innerHTML=l.customPrompt();m.querySelector(".input").focus();l.term=m;l.bootTerminalStart(document.getElementById("terminal"));return l};l.initSession=function(){l.history=(localStorage.getItem("history")?localStorage.getItem("history").split(","):[]);l.historyIndex=l.history.length;var m=(localStorage.getItem("filesystem")?localStorage.getItem("filesystem"):originalFilesystem);l.filesystem=(new DOMParser).parseFromString(m,"text/xml");l.path="/";path=l.path;l.filesystemPointer=l.filesystem.querySelector("d")};return l})();function extendObject(c,a){for(var b in a){a.hasOwnProperty(b)&&(c[b]=a[b])}return c}var bootMessageLines=["System loading...<br>",(new Date()).toString()+"<br>","&nbsp;_______&nbsp;&nbsp;&nbsp;______&nbsp;<br>|__&nbsp;&nbsp;&nbsp;__|&nbsp;|&nbsp;&nbsp;____|<br>&nbsp;&nbsp;&nbsp;|&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;|__&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;|&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;__|&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;|&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;|_|&nbsp;&nbsp;&nbsp;&nbsp;|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>","Terminal Faker version "+version+"<br>","By Sherri Wheeler (SyntaxSeed.com)<br>","Ready. Type 'help' to get started.<br><br>"];"use strict";function _instanceof(b,a){if(a!=null&&typeof Symbol!=="undefined"&&a[Symbol.hasInstance]){return a[Symbol.hasInstance](b)}else{return b instanceof a}}function _classCallCheck(a,b){if(!_instanceof(a,b)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(d,b){for(var a=0;a<b.length;a++){var c=b[a];c.enumerable=c.enumerable||false;c.configurable=true;if("value" in c){c.writable=true}Object.defineProperty(d,c.key,c)}}function _createClass(c,a,b){if(a){_defineProperties(c.prototype,a)}if(b){_defineProperties(c,b)}return c}var Tea=function(){function j(){_classCallCheck(this,j)}_createClass(j,null,[{key:"encrypt",value:function d(r,o){r=String(r);o=String(o);if(r.length==0){return""}var n=j.strToLongs(j.utf8Encode(r));var m=j.strToLongs(j.utf8Encode(o).slice(0,16));var q=j.encode(n,m);var l=j.longsToStr(q);var p=j.base64Encode(l);return p}},{key:"decrypt",value:function b(l,p){l=String(l);p=String(p);if(l.length==0){return""}var o=j.strToLongs(j.base64Decode(l));var n=j.strToLongs(j.utf8Encode(p).slice(0,16));var q=j.decode(o,n);var r=j.longsToStr(q);var m=j.utf8Decode(r.replace(/\0+$/,""));return m}},{key:"encode",value:function c(x,r){if(x.length<2){x[1]=0}var o=x.length;var B=2654435769;var l=Math.floor(6+52/o);var u=x[o-1],w=x[0];var A,t,s=0;while(l-->0){s+=B;t=s>>>2&3;for(var m=0;m<o;m++){w=x[(m+1)%o];A=(u>>>5^w<<2)+(w>>>3^u<<4)^(s^w)+(r[m&3^t]^u);u=x[m]+=A}}return x}},{key:"decode",value:function h(x,r){var o=x.length;var B=2654435769;var l=Math.floor(6+52/o);var u=x[o-1],w=x[0];var A,t,s=l*B;while(s!=0){t=s>>>2&3;for(var m=o-1;m>=0;m--){u=x[m>0?m-1:o-1];A=(u>>>5^w<<2)+(w>>>3^u<<4)^(s^w)+(r[m&3^t]^u);w=x[m]-=A}s-=B}return x}},{key:"strToLongs",value:function a(o){var m=new Array(Math.ceil(o.length/4));for(var n=0;n<m.length;n++){m[n]=o.charCodeAt(n*4)+(o.charCodeAt(n*4+1)<<8)+(o.charCodeAt(n*4+2)<<16)+(o.charCodeAt(n*4+3)<<24)}return m}},{key:"longsToStr",value:function f(m){var o="";for(var n=0;n<m.length;n++){o+=String.fromCharCode(m[n]&255,m[n]>>>8&255,m[n]>>>16&255,m[n]>>>24&255)}return o}},{key:"utf8Encode",value:function k(l){return unescape(encodeURIComponent(l))}},{key:"utf8Decode",value:function g(l){try{return decodeURIComponent(escape(l))}catch(m){return l}}},{key:"base64Encode",value:function e(l){if(typeof btoa!="undefined"){return btoa(l)}if(typeof Buffer!="undefined"){return new Buffer(l,"binary").toString("base64")}throw new Error("No Base64 Encode")}},{key:"base64Decode",value:function i(l){if(typeof atob=="undefined"&&typeof Buffer=="undefined"){throw new Error("No base64 decode")}try{if(typeof atob!="undefined"){return atob(l)}if(typeof Buffer!="undefined"){return new Buffer(l,"base64").toString("binary")}}catch(m){throw new Error("Invalid ciphertext")}}}]);return j}();var builtInCommands={};builtInCommands.cat={about:"cat [file]<br>&nbsp;&nbsp;Display the contents of the specified file.",exe:function(a){if(a.length!=2){return"No such file."}var b=term.catFile(a[1]);if(b===false){return"No such file, or argument is a directory."}b=(b+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2");return b}};builtInCommands.cd={about:"cd [path]<br>&nbsp;&nbsp;Change directory to the specified path.",exe:function(a){if(a.length!=2){return""}var b=term.changeDirectory(a[1]);if(!b){return"No such directory."}return""}};builtInCommands.clear={about:"clear<br>&nbsp;&nbsp;Clear the terminal window.",exe:function(){return""}};builtInCommands.echo={about:"echo [string]<br>&nbsp;&nbsp;Display a line of text.",exe:function(a){var b=a.slice();b.shift();return b.join(" ")}};builtInCommands.encrypt={about:"encrypt [message] [password]<br>&nbsp;&nbsp;Encrypt a provided message using the password.",exe:function(a){if(a.length!=3){return"encrypt: Invalid number of arguments."}var b=Tea.encrypt(a[1],a[2]);return b}};builtInCommands.decrypt={about:"decrypt [encoded] [password]<br>&nbsp;&nbsp;Decrypt a provided message using the password.",exe:function(a){if(a.length!=3){return"decrypt: Invalid number of arguments."}var b=Tea.decrypt(a[1],a[2]);return b}};builtInCommands.help={about:"help [command]<br>&nbsp;&nbsp;Show a list of available commands, or help for a specific command.",exe:function(a){var b="";if(a.length==2&&a[1]&&a[1].toLowerCase() in commands){b+="<strong>"+a[1].toLowerCase()+"</strong>: "+commands[a[1].toLowerCase()].about+""}else{b+="TERMFAKE bash, version "+version+"-release (x86_64-pc-linux-gnu)<br>These shell commands are defined internally.  Type 'help' to see this list.<br>Type 'help name' to find out more about the function 'name'.<br><br>";b+="";Object.keys(commands).sort().forEach(function(c){if(!commands[c].hidden){b+="<strong>"+c+"</strong>&nbsp; "}})}b+="<br><br>";return b}};builtInCommands.history={about:"history [-c]<br>&nbsp;&nbsp;Display the list of recent commands.<br>&nbsp;&nbsp;-c clear the history list.",exe:function(a){if(a.length==2&&a[1]=="-c"){localStorage.setItem("history",[]);term.history=[]}var c=term.history;var b="";c.forEach(function(e,d){b+=d+"&nbsp;&nbsp;"+e+"<br>"});return b}};builtInCommands.ls={about:"ls [-l]<br>&nbsp;&nbsp;List directory contents.<br>&nbsp;&nbsp;-l list contents vertically.",exe:function(a){var c="";var b=Array.prototype.slice.call(term.filesystemPointer.querySelector("c").children);b.forEach(function(e,d){c+="<span class='filesystem-"+e.nodeName+"'>"+e.getAttribute("name")+"</span>";if(a[1]&&a[1]=="-l"){c+="<br>"}else{c+="&nbsp;&nbsp;"}});return c}};builtInCommands.pwd={about:"pwd<br>&nbsp;&nbsp;Print the name of the current working directory.",exe:function(){return term.path}};builtInCommands.reboot={about:"reboot<br>&nbsp;&nbsp;Reboot the terminal and reset saved environment.",exe:function(){localStorage.removeItem("filesystem");localStorage.removeItem("history");term.initSession();setTimeout(function(){term.bootTerminalStart(document.getElementById("terminal"))},5);return""}};builtInCommands.rm={about:"rm [name]<br>&nbsp;&nbsp;Delete the file with the specified name in the current directory.",exe:function(a){if(a.length==1){return"No filename specified."}if(a.length>2){return"Too many parameters supplied."}var b=term.deleteFile(a[1]);if(b!==true){return b}return""}};builtInCommands.touch={about:"touch [name]<br>&nbsp;&nbsp;Create a file with the specified name in the current directory.",exe:function(a){if(a.length==1){return"No filename specified."}if(a.length>2){return"Too many parameters supplied."}var b=term.makeFile(a[1]);if(b!==true){return b}return""}};builtInCommands.version={about:"version<br>&nbsp;&nbsp;Display the version and attribution of this terminal application.",exe:function(){return"Terminal Faker: version "+version+" (https://github.com/syntaxseed/terminalfaker) by Sherri Wheeler."}};